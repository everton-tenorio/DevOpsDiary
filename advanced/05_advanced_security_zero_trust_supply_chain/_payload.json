[{"data":1,"prerenderedAt":464},["ShallowReactive",2],{"advanced-05_advanced_security_zero_trust_supply_chain":3},{"id":4,"title":5,"body":6,"description":448,"extension":449,"meta":450,"navigation":451,"path":452,"seo":453,"stem":454,"tags":455,"__hash__":463},"advanced/advanced/05_advanced_security_zero_trust_supply_chain.md","Advanced Security - Zero Trust & Supply Chain",{"type":7,"value":8,"toc":437},"minimark",[9,14,33,37,41,268,273,284,288,313,317,322,347,352,368,373,431,434],[10,11,13],"h2",{"id":12},"learning-objectives","Learning Objectives",[15,16,17,21,24,27,30],"ul",{},[18,19,20],"li",{},"Implement Zero Trust principles: never trust, always verify, least privilege everywhere",[18,22,23],{},"Secure the software supply chain with SBOM generation and SLSA compliance",[18,25,26],{},"Enforce security policy as code using OPA/Gatekeeper and Falco",[18,28,29],{},"Implement secrets management at scale with dynamic secrets and automatic rotation",[18,31,32],{},"Conduct and document a threat model for the entire platform",[10,34,36],{"id":35},"requirements","Requirements",[38,39,40],"p",{},"You are required to elevate the security posture of the entire platform to enterprise-grade standards:",[42,43,44,91,137,195,233],"ol",{},[18,45,46,50],{},[47,48,49],"strong",{},"Zero Trust Architecture",[15,51,52,71,85,88],{},[18,53,54,55,59,60],{},"Document the Zero Trust model for your platform in ",[56,57,58],"code",{},"zero-trust-design.md",":\n",[15,61,62,65,68],{},[18,63,64],{},"Identity as the new perimeter: every service, user, and workload must authenticate",[18,66,67],{},"Define trust boundaries and how they are enforced",[18,69,70],{},"Map every internal communication and classify: authenticated? encrypted? authorized?",[18,72,73,74],{},"Implement workload identity:\n",[15,75,76,79,82],{},[18,77,78],{},"Configure SPIFFE/SPIRE or use cloud-native workload identity (AWS IRSA, GKE Workload Identity)",[18,80,81],{},"Every Pod must authenticate with a short-lived, automatically rotated identity",[18,83,84],{},"No long-lived static credentials in Pods",[18,86,87],{},"Implement mutual TLS for all service-to-service communication (service mesh from Intermediate level)",[18,89,90],{},"Configure AuthorizationPolicies that deny by default and allow only declared communication paths",[18,92,93,96],{},[47,94,95],{},"Software Supply Chain Security",[15,97,98,112,126],{},[18,99,100,101],{},"Generate a Software Bill of Materials (SBOM) for every container image:\n",[15,102,103,106,109],{},[18,104,105],{},"Use Syft to generate SBOM in SPDX or CycloneDX format",[18,107,108],{},"Attest and sign the SBOM with Cosign",[18,110,111],{},"Store the SBOM alongside the image in the registry",[18,113,114,115],{},"Implement SLSA Level 2 compliance for your CI/CD pipeline:\n",[15,116,117,120,123],{},[18,118,119],{},"Provenance: the pipeline must generate and sign build provenance",[18,121,122],{},"Hermetic builds: builds must not access the internet during compilation",[18,124,125],{},"Verify provenance before deployment: the GitOps controller must reject images without valid provenance",[18,127,128,129],{},"Sign all container images with Cosign:\n",[15,130,131,134],{},[18,132,133],{},"Enable Sigstore keyless signing in CI",[18,135,136],{},"Configure the cluster to reject unsigned images via admission webhook",[18,138,139,142],{},[47,140,141],{},"Policy as Code",[15,143,144,178,181],{},[18,145,146,147],{},"Deploy OPA Gatekeeper with the following policies:\n",[15,148,149,152,155,158,164],{},[18,150,151],{},"All containers must run as non-root",[18,153,154],{},"All containers must have resource requests and limits defined",[18,156,157],{},"Images must come from approved registries only",[18,159,160,161],{},"All Deployments must have at least 2 replicas in ",[56,162,163],{},"prod",[18,165,166,167,170,171,170,174,177],{},"No Pods without required labels (",[56,168,169],{},"team",", ",[56,172,173],{},"environment",[56,175,176],{},"service",")",[18,179,180],{},"Test each policy: deploy a violating resource and verify rejection",[18,182,183,184],{},"Deploy Falco for runtime security:\n",[15,185,186,189,192],{},[18,187,188],{},"Configure rules to detect: shell spawned in a container, unexpected network connection, privilege escalation",[18,190,191],{},"Route Falco alerts to your AlertManager",[18,193,194],{},"Simulate each threat and verify detection",[18,196,197,200],{},[47,198,199],{},"Secrets Management at Scale",[15,201,202,216,219,230],{},[18,203,204,205],{},"Implement dynamic secrets with HashiCorp Vault:\n",[15,206,207,210,213],{},[18,208,209],{},"Database secrets engine: Vault generates short-lived PostgreSQL credentials on request",[18,211,212],{},"Credentials expire after 1 hour and are automatically rotated",[18,214,215],{},"No static database passwords anywhere in the platform",[18,217,218],{},"Configure the Vault Agent Injector or External Secrets Operator to deliver secrets to Pods",[18,220,221,222],{},"Implement automatic secret rotation for:\n",[15,223,224,227],{},[18,225,226],{},"TLS certificates (via cert-manager with short TTL)",[18,228,229],{},"Cloud provider API keys (via Vault cloud secrets engines)",[18,231,232],{},"Audit all secrets access: every read must be logged and alertable",[18,234,235,238],{},[47,236,237],{},"Platform Threat Model",[15,239,240,254],{},[18,241,242,243],{},"Create a comprehensive threat model for the full platform using STRIDE:\n",[15,244,245,248,251],{},[18,246,247],{},"Map the full data flow: developer laptop → CI/CD → registry → cluster → user",[18,249,250],{},"Identify threats at each stage",[18,252,253],{},"Document implemented mitigations and accepted residual risks",[18,255,256,257],{},"Run a dependency audit across all platform components:\n",[15,258,259,262,265],{},[18,260,261],{},"Use Grype or Trivy to scan all Helm chart images",[18,263,264],{},"Identify and remediate all CRITICAL CVEs",[18,266,267],{},"Document the patching SLA: CRITICAL ≤ 24h, HIGH ≤ 7 days",[269,270,272],"h3",{"id":271},"stretch-goals","Stretch Goals",[15,274,275,278,281],{},[18,276,277],{},"Achieve SLSA Level 3 by implementing hermetic builds in an isolated build environment",[18,279,280],{},"Implement a Software Composition Analysis (SCA) gate in CI that blocks deployment on new CRITICAL CVEs",[18,282,283],{},"Configure audit log shipping from Kubernetes API server to an external SIEM (Splunk, Elastic Security)",[269,285,287],{"id":286},"deliverables","Deliverables",[15,289,290,295,298,301,304,307,310],{},[18,291,292,294],{},[56,293,58],{}," with architecture and trust boundary documentation",[18,296,297],{},"SBOM generation integrated in CI, signed and stored with images",[18,299,300],{},"Cosign image signing with cluster admission enforcement",[18,302,303],{},"OPA Gatekeeper policies with test evidence (admitted and rejected resources)",[18,305,306],{},"Falco configuration with alert routing and detection evidence",[18,308,309],{},"Dynamic secrets configuration in Vault with rotation demonstrated",[18,311,312],{},"Platform threat model document with STRIDE analysis",[269,314,316],{"id":315},"references","References",[38,318,319],{},[47,320,321],{},"Books",[15,323,324,333,340],{},[18,325,326],{},[327,328,332],"a",{"href":329,"rel":330},"https://www.oreilly.com/library/view/zero-trust-networks/9781491962183/",[331],"nofollow","Zero Trust Networks - Evan Gilman & Doug Barth",[18,334,335],{},[327,336,339],{"href":337,"rel":338},"https://www.oreilly.com/library/view/hacking-kubernetes/9781492081722/",[331],"Hacking Kubernetes - Andrew Martin & Michael Hausenblas",[18,341,342],{},[327,343,346],{"href":344,"rel":345},"https://www.oreilly.com/library/view/software-supply-chain/9781098133702/",[331],"Software Supply Chain Security - Cassie Crossley",[38,348,349],{},[47,350,351],{},"Courses and Certifications",[15,353,354,361],{},[18,355,356],{},[327,357,360],{"href":358,"rel":359},"https://training.linuxfoundation.org/certification/certified-kubernetes-security-specialist/",[331],"Certified Kubernetes Security Specialist (CKS)",[18,362,363],{},[327,364,367],{"href":365,"rel":366},"https://www.sans.org/cyber-security-courses/cloud-security-devsecops-automation/",[331],"SANS SEC540: Cloud Security and DevSecOps Automation",[38,369,370],{},[47,371,372],{},"Tools and Documentation",[15,374,375,382,389,396,403,410,417,424],{},[18,376,377],{},[327,378,381],{"href":379,"rel":380},"https://spiffe.io/",[331],"SPIFFE/SPIRE",[18,383,384],{},[327,385,388],{"href":386,"rel":387},"https://docs.sigstore.dev/",[331],"Sigstore / Cosign",[18,390,391],{},[327,392,395],{"href":393,"rel":394},"https://github.com/anchore/syft",[331],"Syft SBOM Generator",[18,397,398],{},[327,399,402],{"href":400,"rel":401},"https://slsa.dev/",[331],"SLSA Framework",[18,404,405],{},[327,406,409],{"href":407,"rel":408},"https://open-policy-agent.github.io/gatekeeper/",[331],"OPA Gatekeeper",[18,411,412],{},[327,413,416],{"href":414,"rel":415},"https://falco.org/docs/",[331],"Falco Runtime Security",[18,418,419],{},[327,420,423],{"href":421,"rel":422},"https://developer.hashicorp.com/vault/docs",[331],"HashiCorp Vault",[18,425,426],{},[327,427,430],{"href":428,"rel":429},"https://github.com/anchore/grype",[331],"Grype Vulnerability Scanner",[432,433],"hr",{},[38,435,436],{},"Once you complete this task your platform will enforce security at every layer - from the moment code is committed to when it runs in production - making the entire supply chain auditable, signed, and policy-controlled.",{"title":438,"searchDepth":439,"depth":439,"links":440},"",2,[441,442],{"id":12,"depth":439,"text":13},{"id":35,"depth":439,"text":36,"children":443},[444,446,447],{"id":271,"depth":445,"text":272},3,{"id":286,"depth":445,"text":287},{"id":315,"depth":445,"text":316},"Implement Zero Trust architecture, software supply chain security, and policy as code across the platform","md",{},true,"/advanced/05_advanced_security_zero_trust_supply_chain",{"title":5,"description":448},"advanced/05_advanced_security_zero_trust_supply_chain",[456,457,458,459,460,461,462],"advanced","devsecops","zero-trust","supply-chain","sbom","slsa","devops","Ij1IC4UVa15zIkVDmhgmQjves69-rF6OzZoQlANclWI",1772318814498]